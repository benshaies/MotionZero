#include "level.h"
#include "stdio.h"
#include "stdlib.h"
#include "string.h"
#include "enemy.h"

char *fileName;

int level1[54][32] = {
    -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, 4 , 4 , 4 , 4 , 5 , 5 , 4 , 4 , 4 , 4,
    -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, 4 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 4,
    -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, 4 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 4,
    -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, 4 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 4,
    -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, 4 , 0 , 0 , 1 , 0 , 0 , 2 , 0 , 0 , 4,
    -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, 4 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 4,
    -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, 4 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 4,
    -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, 4 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 4,
    -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, 4 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 4,
    -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, 4 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 4,
    -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, 4 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 4,
    -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, 4 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 4,
    -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, 4 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 4,
    -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, 4 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 4,
    -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, 4 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 4,
    -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, 4 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 4,
    -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, 4 , 2 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 4,
    -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, 4 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 4,
    -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, 4 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 4,
    -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, 4 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 4,
    -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, 4 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 4,
    -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, 4 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 4,
    4 , 4 , 4 , 4 , 4 , 4 , 4 , 4 , 4 , 4 , 4 , 4 , 4 , 4 , 4 , 4 , 4 , 4 , 4 , 4 , 4 , 4 , 4 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 4,
    4 , 0 , 0 , 0 , 2 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 4,
    4 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 4,
    4 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 4,
    4 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 3 , 4,
    4 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 4,
    4 , 2 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 4,
    4 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 4,
    4 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 1 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 2 , 0 , 0 , 0 , 0 , 0 , 0 , 4,
    4 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 4 , 4 , 4 , 4 , 4 , 4 , 4 , 4 , 4 , 4 , 4 , 4 , 4 , 4 , 4 , 4 , 4 , 4 , 4 , 4 , 4 , 4 , 4,
    4 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 4 , -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
    4 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 4 , -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
    4 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 4 , -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
    4 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 4 , -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
    4 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 4 , -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
    4 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 4 , -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
    4 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 4 , -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
    4 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 4 , -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
    4 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 4 , -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
    4 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 4 , -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
    4 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 4 , -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
    4 , 1 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 4 , -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
    4 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 4 , -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
    4 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 4 , -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
    4 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 4 , -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
    4 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 4 , -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
    4 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 4 , -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
    4 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 4 , -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
    4 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 4 , -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
    4 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 4 , -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
    4 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 4 , -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
    4 , 4 , 4 , 4 , 4 , 4 , 4 , 4 , 4 , 4 , -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
};

//Sets up level struct and allocated memory for array
void levelInit(Level *level, int levelNum){
    level->num = levelNum;
    switch (levelNum){
        case 1:
            level->width = 32;
            level->height = 54;
            level->startPos = (Vector2){4*TILE_SIZE, 51*TILE_SIZE};

            //Level rec init
            level->RecNum = 3;
            level->rec = malloc(sizeof(Rectangle) * level->RecNum);

            level->rec[0] = (Rectangle){100, 2300, 800, 3000};
            level->rec[1] = (Rectangle){900, 2300, 2200, 800};
            level->rec[2] = (Rectangle){2300, 100, 800, 2200};
            break;
    }

    level->array = malloc(level->height * sizeof(int*));
    for(int i = 0; i < level->height; i++){
        level->array[i] = malloc(level->width * sizeof(int));
    }
}

//Loads struct array with level data
void loadLevel(Level *level){

    for(int y = 0; y < level->height; y++){
        for(int x = 0; x < level->width; x++){
            switch (level->num){
                case 1:
                    level->array[y][x] = level1[y][x];
                    break;
            }
        }
    }
    
}

//Takes level array and spawns in enemies
void loadLevelEnemies(Level *level){
    for(int y = 0; y < level->height; y++){
        for(int x = 0; x < level->width; x++){
            
            if(level->array[y][x] == 1 || level->array[y][x] == 2 || level->array[y][x] == 3){
                enemyInit((Vector2){x*TILE_SIZE, y*TILE_SIZE}, level->array[y][x]);
            }
        }
    }
}

//Draws level
void drawLevel(Level *level){
    for(int y = 0; y < level->height; y++){
        for(int x = 0; x < level->width; x++){
            switch (level->array[y][x]){
                case 4: //Drawing walls
                    DrawRectangle(TILE_SIZE*x, TILE_SIZE*y, TILE_SIZE, TILE_SIZE, GREEN);
                    break;
                case 5:
                    DrawRectangle(TILE_SIZE*x, TILE_SIZE*y, TILE_SIZE, TILE_SIZE, GOLD);
                    break;
            }
        }
    }
}